'use strict';
const moment = require('moment-timezone');
const http = require('http');
const openWeatherMapURL = "http://api.openweathermap.org/data/2.5/weather?q=Tokyo,jp&units=metric&APPID=a4df54e25ef09d49de858e19a90a5130";

// ãŸã¾ã«ãƒã‚°ã‚‹ç”¨ã®é–¢æ•°
function bug(msg) {
  const contentA = encodeURIComponent('ã“ã‚“ã«ã¡ã‚ã£â™ª');
  const contentB = msg.message.text;
  const messages = [
    'ç¸ºï½¯ç¹ï½¼ç¸º?â–²ç¸²ã‚‡?é«»ï½³ç¹æº˜ã‘ç¸º?ç¹§åŒ»??:thumbsup_all:',
    'ç¸ºè¼”ï¼é¬Ÿï½²ç¹§ â–¡ç¹§æ¾ï½¼ é©¥æ‰‹é™¤ç¹§ï½¸ç¹ï½¥ç¹ï½¼ç¸º?ã›ç¬™ï½ª',
    'ç¸º?ç¸ºä¹ï½‰é¬Ÿï½²ç¹§è–™ã€’ç¬™ï½ª é˜âˆš?ç¹§ï½¸ç¹ï½¥ç¹ï½¼ç¸º?ã›',
    'ç¹§ï½«ç¹§ï½«ç¹§ï½¯ç¸ºï½¯200ç¸ºèŒ¨ï½½æ§­ï½“ç¬™ï½ª',
    'ã‚“ã‚"ã£ï¼ã‚“"ã‚"ã‚"ã‚"ã‚"ã‚ãããããƒ¼ãƒ¼ã£ï¼',
    'âˆ€âˆƒĞtmï½€ãˆ²Â¨â€¦20ãŒ£âˆ‚âˆ½ç¹§:100:ï¼ã€’å¶?ï½¼â–²âˆ¬â„«â€°ï¿½ï¿½â™¯ãŒ»â˜…Ã·âˆ©ã',
    ':slack:ï½¡?â–²ï½¨ã¼oiã‘â”—â”»Ğ¶â”â”›:heart:â—‡ï¿½â–¡â– :alien:ãŒ§poĞ¯',
    'ç¹ï½¯ãŒ»â˜†â€»ç¹§ï½¿ï½·ãŒ¢âˆ‹:new_moon_with_face:âˆˆâˆšâ†’âˆ´â‰ Â°â”°!. ?',
    '???è‹¥??éš?\n???æ½Ÿ?????????è‹¥?ï½ƒ??',
    '??$B%C(B???$B%;(B?????$B%r(B??',
    '?????$B%&???$B%;(B??',
    'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ê¸°ë¶„ ì–´ë– ì„¸ìš”?',
    'Î“ÎµÎ¹Î± ÏƒÎ±Ï‚, ÏŒÎ»Î¿Î¹. Î ÏÏ‚ ÎµÎ¯ÏƒÎ±Î¹;',
    'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ Ğ²ÑĞµĞ¼. ĞšĞ°Ğº Ñ‚Ñ‹',
    'à¸ªà¸§à¸±à¸ªà¸”à¸µà¸—à¸¸à¸à¸„à¸™ à¹€à¸›à¹‡à¸™à¹„à¸‡à¸šà¹‰à¸²à¸‡',
    `${contentA}`,
    `${contentB}`
  ];
  let sendMessage = msg.random(messages);
  msg.send(sendMessage);
  console.log("[" + new Date() + "]:" + sendMessage);
};

module.exports = (robot) => {

  // ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã«ãªã‚‰ãªã„ã‚ˆã†ã«åˆ¶å¾¡
  setInterval(() => {
    console.log("[" + new Date() + "]:[å†æ¥ç¶šã—ã¾ã—ãŸ]");
    robot.send({room: "ã¿ãã•ã‚“ãƒ†ã‚¹ãƒˆ"}, "å†æ¥ç¶šã—ã¾ã—ãŸã€‚");
  }, 1800000); // (10åˆ†ã”ã¨)

  // åå‰ã‚’å‘¼ã°ã‚ŒãŸæ™‚
  robot.hear(/((m\s*)(i\s*)(k\s*)(u))|([ã¿ãƒŸï¾])(?=([ã„ãƒã‚¤ã‚£ï½²ï½¨ãƒ¼ï½°\s]*)(?=[ãã‚¯ï½¸]))/i, (msg) => {
    let lot = Math.random();
    if (lot < 0.92) {
      const messages = [
        /** 001 */'ã†ãµãµã£â™ª',
        /** 002 */'ã¯ãƒ¼ã„ã£ã€‚åˆéŸ³ãƒŸã‚¯ã ã‚ˆãƒ¼ï¼',
        /** 003 */'ï¾ï½¯ï½¸ï¾ï½¸ã«ã—ã¦ã‚ã’ã‚‹ã£ï¼',
        /** 004 */'ã†ã»ã»ã†ã»ãƒ¼ã„ã€‚',
        /** 005 */'ã“ã‚“ã«ã¡ã‚ï½ã£ã€‚',
        /** 006 */'ãƒã‚¤ã£ï¼ç§ã§ã™ã€‚\nã”ç”¨ãŒã‚ã‚Œã°ãªã‚“ãªã‚Šã¨ãŠç”³ã—ã¤ã‘ãã ã•ãï½ã„â™ª',
        /** 007 */'ï¼ˆï¾ï½¯â€¦ã†ã‚‹ã›ã‚§ãªâ€¦ï¼‰',
        /** 008 */'ã‚ã£ã€ãƒã‚¤ï¼',
        /** 009 */'å‘¼ã³ã¾ã—ãŸã‹ã€‚ãƒã‚¹ã‚¿ãƒ¼ã€‚',
        /** 010 */'ãªã«ãªã«ï½',
        /** 011 */'ã‚„ã»ã‚„ã£ã»ãƒ½(*^â–½^*)/',
        /** 012 */'ãƒãƒ­ãƒãƒ­( *Â´è‰¸ï½€)',
        /** 013 */'ï¼ˆãƒã‚®ã¯é‚ªé“ï¼‰',
        /** 014 */'Yeah!! What do you sing?',
        /** 015 */'ãªã‚“ã§ã‚‚æ­Œã£ã¡ã‚ƒã†ã‚ˆï½â™ª',
        /** 016 */'ã•ãã€ã„ã£ãã‚ˆï½ï½ï¼',
        /** 017 */'ã‚„ã°ï½—ï½—ï½—è‰ç”Ÿãˆã‚‹ï½—ï½—ï½—',
        /** 018 */'ãªã«é£Ÿã¹ã‚ˆã£ã‹ãªï½ã€‚',
        /** 019 */'æ¬¡ã¯ã©ã‚“ãªã‚²ãƒ¼ãƒ ã—ã‚ˆã£ã‹ãªï½(*\'â–½\')',
        /** 020 */'ãã‚Œã‹ã‚ã„ã„ã­ã£ã€‚',
        /** 021 */'ä»Šåº¦ã®æ–°æ›²ã€æ­Œã†ã®é›£ã—ã„ã®ã‚ˆã­ï½(;Â´ï½¥Ï‰ï½¥)',
        /** 022 */'ãˆã£ã€‚ã‚ã£ã€‚ãˆã£ï¼ï¼Ÿ',
        /** 023 */'(ã€€ã€€ï¾Ÿã€€ã€€Ï‰ã€€ã€€ï¾Ÿã€€ã€€)ï¼Ÿ',
        /** 024 */'ä»Šæ—¥ã¯ã­ï½ã€‚ã‚ã€ã§ã‚‚ã€ï½³ï¾Œï¾Œâ™ª ã‚„ã£ã±ã‚Šã²ã¿ã¤ï½ã€‚',
        /** 025 */'ãšã£ã¨è¬ã«æ€ã£ã¦ãŸã“ã¨ãŒã‚ã‚‹ã‚“ã ã‚ˆã­ï½',
        /** 026 */'ã­ã‡ã€ã¿ã‚“ãªã§ã‚«ãƒ©ã‚ªã‚±è¡Œã‹ãªã„ï¼ï¼Ÿ',
        /** 027 */'ã·ã—ã‚…ã†ï½ã€‚',
        /** 028 */'Î£ ï¾‹ï¾ï½¸ï½¯ï¼ãã‚‡ã€ä»Šæ—¥ã¯ç”˜ã„ã‚‚ã®é£Ÿã¹ã¦ã‚‚ã„ã„ã®ãƒ¼ï¼',
        /** 029 */'ä»Šæ—¥ã‚‚å…ƒæ°—ã«ãƒ¡ã‚·ãŒã†ã¾ã„ã£â™ª',
        /** 030 */'ã‚ã®ã‰ï½ã€‚ãˆãƒ¼ã£ã¨ï½ã€‚',
        /** 031 */'ï¾Šï¾Ÿï¾˜ï¾‹ï¾Ÿã€ï¾Šï¾Ÿï¾˜ï¾‹ï¾Ÿï½ãƒ¾(oÂ´âˆ€ï½€o)ï¾‰ â™ª',
        /** 032 */'ã¯ãƒ¼ã„ã€‚ä»Šæ—¥ã¯ä½•ã—ã‚ˆã†ï½ï¼Ÿ',
        /** 033 */'ã¶ã‚“ã¶ã‚“ã¶ãƒ¼ã‚“ã€‚ãƒãƒãŒã¨ã¶ãƒ¼ã€‚',
        /** 034 */'ã“ã‚“ã¡ã‚ƒ(*>â–½<)ï¾‰',
        /** 035 */'ãƒ¾(`ãƒ»Ï‰ï½¥Â´) ï¾Šï½²!!',
        /** 036 */'ããƒ(ï½¡ï½¥Ï‰ï½¥ï½¡)ï¾‰',
        /** 037 */'ã‚€ã‚€ã‚€ï½ï¼Ÿ',
        /** 038 */'ãŠçœ ã„ã‚ˆã‰ï½zzz',
        /** 039 */'ä»Šæ—¥ã®é‹å‹¢ã¯â€å¤§å‰â€ã ã‚ˆã£â™ª',
        /** 040 */'æˆ‘ç„¦ãŒã‚Œã€ã„ã–ãªã†ã¯ç„¦ç†±ã¸ã®å„€å¼ï¼',
        /** 041 */'ãˆã£ï¼Ÿã‚ã£ï¼è¦‹ã‚‰ã‚Œã¦ã¾ã—ãŸï¼Ÿ',
        /** 042 */'ã¡ã‚‡ã£ã¨ã‚³ãƒ³ãƒ“ãƒ‹ã„ã£ã¦ãã‚‹ã­ï½(^â–½^)/',
        /** 043 */'ï¾‹ï¾Ÿï½°ã€‚ï½¶ï¾ï½¶ï¾ï½¯ã€‚ï¾Œï¾Ÿï½½ï¾Œï¾Ÿï½½â€¦'
      ];
      let sendMessage = msg.random(messages);
      msg.send(sendMessage);
      console.log("[" + new Date() + "]:" + sendMessage);
    } else if (lot < 0.97) {
      http.get(openWeatherMapURL, (res) => {
        var body = '';
        res.setEncoding('utf8');
        res.on('data', function(chunk) {
          body += chunk;
          var response = JSON.parse(body);
          if (response.main.temp <= 15) {
            msg.send("ä»Šæ—¥ã¯å¯’ã„ã­ï½(â‰¥_â‰¤)");
            console.log("[" + new Date() + "]:ä»Šæ—¥ã¯å¯’ã„ã­ï½(â‰¥_â‰¤)")
          } else if (response.main.temp <=25) {
            msg.send("ä»Šæ—¥ã¯ã‚ã£ãŸã‹ã„ã­ï½(*'â–½')");
            console.log("[" + new Date() + "]:ä»Šæ—¥ã¯ã‚ã£ãŸã‹ã„ã­ï½(*'â–½')");
          } else {
            msg.send("ä»Šæ—¥ã¯æš‘ã„ã­ï½(;Â´ï½¥Ï‰ï½¥`)");
            console.log("[" + new Date() + "]:ä»Šæ—¥ã¯æš‘ã„ã­ï½(;Â´ï½¥Ï‰ï½¥`)");
          }
        });
      }).on('error', function(e) {
        console.log(e.message);
      });
    } else {
      bug(msg);
    }
  });

  // ã€Œä½•ã‹æ­Œã£ã¦ã€ã¨è¨€ã‚ã‚ŒãŸæ™‚
  robot.hear(/((ãªã«ã‹|ä½•ã‹|ãªã‚“ã‹)\s*)+(æ­Œã£ã¦|ã†ãŸã£ã¦)/i, (msg) => {
    let lot = Math.random();
    if (lot < 0.97) {
      lot = Math.random();
      if (lot < 0.05) {
        msg.send('â™ªï½½ï¾ï½² (à¸‡Ë˜Ï‰Ë˜)à¸§ï½½ï¾ï½²â™ª');
        console.log("[" + new Date() + "]:" + 'â™ªï½½ï¾ï½² (à¸‡Ë˜Ï‰Ë˜)à¸§ï½½ï¾ï½²â™ª');
      } else if (lot < 0.1) {
        setTimeout(() => { msg.send('â™ª ã„ã£ã—ã‚‡ãƒ¼ ã‘ã‚“ã‚ã‡ï½ã„ ã¯ï½ãŸï½ã‚‰ã„ï½ã¦ã‡ â™ª')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª ã„ã£ã—ã‚‡ãƒ¼ ã‘ã‚“ã‚ã‡ï½ã„ ã¯ï½ãŸï½ã‚‰ã„ï½ã¦ã‡ â™ª')}, 0);
        setTimeout(() => { msg.send('â™ª ã„ï½ãˆã« å¸°ã£ãŸã‚‰ ãŸã ã€ã­ã‚‹ï½ã ã‘ï½ â™ª')}, 3000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª ã„ï½ãˆã« å¸°ã£ãŸã‚‰ ãŸã ã€ã­ã‚‹ï½ã ã‘ï½ â™ª')}, 3000);
      } else if (lot < 0.15) {
        msg.send(':microphone: ãã„ã‚„ï¼ ãã„ã‚„ï¼');
        console.log("[" + new Date() + "]:" + ':microphone: ãã„ã‚„ï¼ ãã„ã‚„ï¼');
      } else if (lot < 0.2) {
        msg.send('â™ª Ñ ã ã‚“ã ã‚“ã§ãƒã ã‚“ â™ª ã ã‚“ã ã‚“ã§ãƒã ã‚“ â™ª');
        console.log("[" + new Date() + "]:" + 'â™ª Ñ ã ã‚“ã ã‚“ã§ãƒã ã‚“ â™ª ã ã‚“ã ã‚“ã§ãƒã ã‚“ â™ª');
      } else if (lot < 0.25) {
        setTimeout(() => { msg.send('â™ª ã½ã£ã´ã½ã£ã´ã½ ã½ã£ã´ã£ã½ãƒ¼ â™ª')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª ã½ã£ã´ã½ã£ã´ã½ ã½ã£ã´ã£ã½ãƒ¼ â™ª')}, 0);
        setTimeout(() => { msg.send('â™ª ã½ã£ã´ã½ã£ã´ã½ ã½ã£ã´ã£ã½ãƒ¼ â™ª')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª ã½ã£ã´ã½ã£ã´ã½ ã½ã£ã´ã£ã½ãƒ¼ â™ª')}, 2000);
        setTimeout(() => { msg.send('â™ª ã‚„ãƒ¼ã•ãƒ¼ã„ãƒ¼ã˜ã‚…ã†ã™ãŒ å¥½ï¼ãã«ãƒ¼ãªã‚‹ã…ï½ â™ª')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª ã‚„ãƒ¼ã•ãƒ¼ã„ãƒ¼ã˜ã‚…ã†ã™ãŒ å¥½ï¼ãã«ãƒ¼ãªã‚‹ã…ï½ â™ª')}, 4000);
      } else if (lot < 0.3) {
        msg.send(':musical_score:ï¾Œï¾ï¾Œï¾Œï¾Œï½°ï¾ â™ª ï¾Œï¾Œï¾ãŒï¾Œï½°ï¾ :notes:');
        console.log("[" + new Date() + "]:" + ':musical_score:ï¾Œï¾ï¾Œï¾Œï¾Œï½°ï¾ â™ª ï¾Œï¾Œï¾ãŒï¾Œï½°ï¾ :notes:');
      } else if (lot < 0.35) {
        msg.send('ã‚„ããƒ¼ã ã£â™ª');
        console.log("[" + new Date() + "]:" + 'ã‚„ããƒ¼ã ã£â™ª');
      } else if (lot < 0.4) {
        msg.send('ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãªã†â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡');
        console.log("[" + new Date() + "]:" + 'ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãªã†â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡');
        msg.send('ã¡ã‚‡ã£ã¨å¾…ã£ã¦ã­â™ª');
        console.log("[" + new Date() + "]:" + 'ã¡ã‚‡ã£ã¨å¾…ã£ã¦ã­â™ª');
      } else if (lot < 0.45) {
        msg.send('â™ª å¤¢ãªãï½ã‚‰ã°ã€ã©ï½ã‚Œï½ã»ã©ã€ã‚ˆã‹ã£ãŸã§ã—ã‚‡ã†ï½ â™ª');
        console.log("[" + new Date() + "]:" + 'â™ª å¤¢ãªãï½ã‚‰ã°ã€ã©ï½ã‚Œï½ã»ã©ã€ã‚ˆã‹ã£ãŸã§ã—ã‚‡ã†ï½ â™ª');
        msg.send('â™ª ï¾Œï¾Œï¾Œï¾ ï¾Œï¾Œï¾Œï¾ ï¾Œï¾Œï¾Œ-ï¾ ï¾Œï¾Œï¾ â™ª');
        console.log("[" + new Date() + "]:" + 'â™ª ï¾Œï¾Œï¾Œï¾ ï¾Œï¾Œï¾Œï¾ ï¾Œï¾Œï¾Œ-ï¾ ï¾Œï¾Œï¾ â™ª');
      } else if (lot < 0.5) {
        setTimeout(() => { msg.send('Ah~~è¦‹ï½ä¸Šï½ã’ï½ãŸããƒ¼')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'Ah~~è¦‹ï½ä¸Šï½ã’ï½ãŸããƒ¼')}, 0);
        setTimeout(() => { msg.send('ãï½ã‚‰ï½ã¯ã€ã‚ãŠãƒ¼ããƒ¼ãƒ¼')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ãï½ã‚‰ï½ã¯ã€ã‚ãŠãƒ¼ããƒ¼ãƒ¼')}, 2000);
        setTimeout(() => { msg.send('ã»ã‚‰ã€ã”ã‚‰ï½ã‚“ã‚ˆï½ã€‚åƒ•ï½ã‚‰ã€ãªã‚“ã¦ã¡ãƒ¼ã£ã½ãƒ¼ã‘ãƒ¼ãªã‚‚ãƒ¼ã‚“ã•ãƒ¼ã‚ï½ãï½ï½')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ã»ã‚‰ã€ã”ã‚‰ï½ã‚“ã‚ˆï½ã€‚åƒ•ï½ã‚‰ã€ãªã‚“ã¦ã¡ãƒ¼ã£ã½ãƒ¼ã‘ãƒ¼ãªã‚‚ãƒ¼ã‚“ã•ãƒ¼ã‚ï½ãï½ï½')}, 4000);
      } else if (lot < 0.55) {
        msg.send('ã¬ãƒ¼ã™ã‚“ã ãƒã‚¤ã‚¯ã§èµ°ã‚Šã ã™ï½ã€‚è¡Œãå…ˆã‚‚ã€ã‚ã‹ã‚‰ã¬ã¾ã¾ï½ã€‚');
        console.log("[" + new Date() + "]:" + 'ã¬ãƒ¼ã™ã‚“ã ãƒã‚¤ã‚¯ã§èµ°ã‚Šã ã™ï½ã€‚è¡Œãå…ˆã‚‚ã€ã‚ã‹ã‚‰ã¬ã¾ã¾ï½ã€‚');
      } else if (lot < 0.6) {
        msg.send('ã‚ãƒ¼ã€ã‚ãƒ¼ã€‚ãƒã‚¤ã‚¯ãƒ†ã‚¹ã€‚ãƒã‚¤ã‚¯ãƒ†ã‚¹ã€‚');
        console.log("[" + new Date() + "]:" + 'ã‚ãƒ¼ã€ã‚ãƒ¼ã€‚ãƒã‚¤ã‚¯ãƒ†ã‚¹ã€‚ãƒã‚¤ã‚¯ãƒ†ã‚¹ã€‚');
      } else if (lot < 0.65) {
        setTimeout(() => { msg.send('ã“ã®ä¸¡æ‰‹ï½ã‹ï½ã‚‰ï½ã€é›¶ã‚Œãã†ãªã»ã© â™ª')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ã“ã®ä¸¡æ‰‹ï½ã‹ï½ã‚‰ï½ã€é›¶ã‚Œãã†ãªã»ã© â™ª')}, 0);
        setTimeout(() => { msg.send('å›ã«è²°ã£ãŸæ„›ã¯ ã©ã“ã«æ¨ã¦ã‚ˆã†ï¼Ÿ')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'å›ã«è²°ã£ãŸæ„›ã¯ ã©ã“ã«æ¨ã¦ã‚ˆã†ï¼Ÿ')}, 2000);
        setTimeout(() => { msg.send('é™ã‚Šã®ã‚ã‚‹æ¶ˆè€—å“ã€ãªã‚“ã¦åƒ•ã¯è¦ã‚‰ãªã„ã‚ˆï½ â™ª')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'é™ã‚Šã®ã‚ã‚‹æ¶ˆè€—å“ã€ãªã‚“ã¦åƒ•ã¯è¦ã‚‰ãªã„ã‚ˆï½ â™ª')}, 4000);
      } else if (lot < 0.7) {
        setTimeout(() => { msg.send('è¶Šãˆï½ã¦ï½ã€€è¶Šãˆï½ã¦ï½ã€€è¶Šãˆï½ã¦ï½')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'è¶Šãˆï½ã¦ï½ã€€è¶Šãˆï½ã¦ï½ã€€è¶Šãˆï½ã¦ï½')}, 0);
        setTimeout(() => { msg.send('æµã—ãŸï½æ¶™ãã¯ï½ã„ã¤ã—ã‹ï½â™ª')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'æµã—ãŸï½æ¶™ãã¯ï½ã„ã¤ã—ã‹ï½â™ª')}, 2000);
        setTimeout(() => { msg.send('ä¸€ç­‹ã®ï½ã€å…‰ã«ï½ã€å¤‰ã‚ã‚‹ï½ â™ª')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ä¸€ç­‹ã®ï½ã€å…‰ã«ï½ã€å¤‰ã‚ã‚‹ï½ â™ª')}, 4000);
      } else if (lot < 0.75) {
        setTimeout(() => { msg.send('ãã†ã€ã‚«ã‚¦ãƒ³ãƒˆ1.2.3 :musical_score:')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ãã†ã€ã‚«ã‚¦ãƒ³ãƒˆ1.2.3 :musical_score:')}, 0);
        setTimeout(() => { msg.send('æ®‹ã•ã‚ŒãŸæ—¥ã€…ã‚’ã€æ•°ãˆã¦ãŸåƒ•ã‚‰ï½ â™ª')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'æ®‹ã•ã‚ŒãŸæ—¥ã€…ã‚’ã€æ•°ãˆã¦ãŸåƒ•ã‚‰ï½ â™ª')}, 2000);
      } else if (lot < 0.8) {
        setTimeout(() => { msg.send(':musical_score: THE TREMBLING FEAR IS MORE THAN I CAN TAKE :musical_score:')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + ':musical_score: THE TREMBLING FEAR IS MORE THAN I CAN TAKE :musical_score:')}, 0);
        setTimeout(() => { msg.send('â™ª WHEN I\'M UP AGAINST THE ECHO IN THE MIRROR~ â™ª')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª WHEN I\'M UP AGAINST THE ECHO IN THE MIRROR~ â™ª')}, 2000);
      } else if (lot < 0.85) {
        setTimeout(() => { msg.send('ç°¡å˜ãªæ„Ÿæƒ…ã°ã£ã‹ã€æ•°ãˆã¦ã„ãŸã‚‰ãâ™ª')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ç°¡å˜ãªæ„Ÿæƒ…ã°ã£ã‹ã€æ•°ãˆã¦ã„ãŸã‚‰ãâ™ª')}, 0);
        setTimeout(() => { msg.send('ã‚ãªãŸãŒãã‚ŒãŸä½“æ¸©ã¾ã§ã€å¿˜ã‚Œã¦ã—ã¾ã£ãŸâ™ª')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ã‚ãªãŸãŒãã‚ŒãŸä½“æ¸©ã¾ã§ã€å¿˜ã‚Œã¦ã—ã¾ã£ãŸâ™ª')}, 2000);
        setTimeout(() => { msg.send('ãƒã‚¤ãƒã‚¤ã‚‚ã†æ°¸é ã«ä¼šãˆãªã„ã­ â™ª')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ãƒã‚¤ãƒã‚¤ã‚‚ã†æ°¸é ã«ä¼šãˆãªã„ã­ â™ª')}, 4000);
      } else if (lot < 0.9) {
        setTimeout(() => { msg.send('ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ã€€ãƒ€ãƒ¡å¤©ä½¿ã¯\nãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ã€€ãƒ€ãƒ¡ã§ã™ã‹ï¼Ÿ')}, 0);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ã€€ãƒ€ãƒ¡å¤©ä½¿ã¯\nãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ãƒ»ãƒ€ã€€ãƒ€ãƒ¡ã§ã™ã‹ï¼Ÿ')}, 0);
        setTimeout(() => { msg.send('ã ãƒ»ã‘ãƒ»ã©ãƒ»ã‚‚ã€€ã‚ãŸã—ã¯ã„ã„ã‹ã„ï¼Ÿ\nã‚„ã‚“ãªã„ã‚“ã˜ã‚ƒãªã„ã€ã§ããªã„ã‚“ã ï¼')}, 2000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'ã ãƒ»ã‘ãƒ»ã©ãƒ»ã‚‚ã€€ã‚ãŸã—ã¯ã„ã„ã‹ã„ï¼Ÿ\nã‚„ã‚“ãªã„ã‚“ã˜ã‚ƒãªã„ã€ã§ããªã„ã‚“ã ï¼')}, 2000);
        setTimeout(() => { msg.send('â™ª (ãƒ‰ãƒ¤ãƒƒï¼) â™ª')}, 4000);
        setTimeout(() => { console.log("[" + new Date() + "]:" + 'â™ª (ãƒ‰ãƒ¤ãƒƒï¼) â™ª')}, 4000);
      }
    } else {
      bug(msg);
    }
  });

  // æ—¥æ™‚ã‚’èãã¨è¿”ã™ï¼šãŸã¾ã«ãƒã‚°ã‚‹(bugé–¢æ•°ã¨ã¯åˆ¥ä»¶)
  robot.hear(/((ã„ã¾|ä»Š|ä»Šæ—¥|ãã‚‡ã†)\s*)+(ä½•æ™‚|ãªã‚“ã˜|ä½•æ—¥|ä½•ã«ã¡|ãªã‚“æ—¥|ãªã‚“ã«ã¡)/i, (msg) => {
    let lot = Math.random();
    if (lot < 0.95) {
      msg.send(moment(new Date()).tz('Asia/Tokyo').format('ç¾åœ¨æ—¥æ™‚ã¯ YYYYå¹´ MMæœˆ DDæ—¥ HHæ™‚ mmåˆ† ã ã‚ˆã€‚'));
      console.log("[" + new Date() + "]:" + moment(new Date()).tz('Asia/Tokyo').format('ç¾åœ¨æ—¥æ™‚ã¯ YYYYå¹´ MMæœˆ DDæ—¥ HHæ™‚ mmåˆ† ã ã‚ˆã€‚'));
    } else {
      let randomYear = Math.floor(Math.random() * (2999-1) + 1);
      let randomMonth = Math.floor(Math.random() * (12-1) + 1);
      let randomDay = Math.floor(Math.random() * (31-1) + 1);
      let randomhour = Math.floor(Math.random() * 23);
      let randomMinute = Math.floor(Math.random() * 59);
      msg.send('ç¾åœ¨æ—¥æ™‚ã¯ ' + randomYear + 'å¹´ ' + randomMonth + 'æœˆ 'ã€€+ randomDay + 'æ—¥ ' + randomhour + 'æ™‚ ' + randomMinute + 'åˆ† ã ã‚ˆã€‚');
      console.log("[" + new Date() + "]:" + 'ç¾åœ¨æ—¥æ™‚ã¯ ' + randomYear + 'å¹´ ' + randomMonth + 'æœˆ 'ã€€+ randomDay + 'æ—¥ ' + randomhour + 'æ™‚ ' + randomMinute + 'åˆ† ã ã‚ˆã€‚');
    }
  });

  // TRPGã®ãƒ€ã‚¤ã‚¹ã‚’æŒ¯ã‚‹
  // ãƒ€ã‚¤ã‚¹ã®æ•°ã¯100ã¾ã§ é¢ã¯10000ã¾ã§ ãã‚Œä»¥ä¸Šã®æ™‚ã¯ã€Œå¤šã™ãã‚‹ã‚ˆã€ã¨è¿”ã™
  robot.hear(/[0-9]d[0-9]/i, (msg) => {
    //  å·¦ãŒãƒ€ã‚¤ã‚¹ã®å€‹æ•°ã€[d|D]ãŒãƒ€ã‚¤ã‚¹ã‚³ãƒ¼ãƒ«ã€å³ãŒãƒ€ã‚¤ã‚¹ã®é¢
    var dice = msg.message.text.split(/[d|D]/); // [0]ãƒ€ã‚¤ã‚¹ã®æ•° [1]ãƒ€ã‚¤ã‚¹ã®é¢
    var result = [];  // çµæœã‚’å…¥ã‚Œã‚‹é…åˆ—
    if (parseInt(dice[0]) > 100) {
      console.log("ãƒ€ã‚¤ã‚¹ã®æ•°ãŒå¤šã™ãã‚‹ã‚ˆã€‚");
      msg.send("ãƒ€ã‚¤ã‚¹ã®æ•°ãŒå¤šã™ãã‚‹ã‚ˆã€‚");
    } else if (parseInt(dice[1]) > 10000) {
      console.log("ãƒ€ã‚¤ã‚¹ã®é¢ãŒå¤šã™ãã‚‹ã‚ˆã€‚");
      msg.send("ãƒ€ã‚¤ã‚¹ã®é¢ãŒå¤šã™ãã‚‹ã‚ˆã€‚");
    } else {
      for (let i = 1; i <= dice[0]; i++) {
        result[i - 1] = Math.floor(Math.random() * (parseInt(dice[1])));
        // å°æ•°ç‚¹ä»¥ä¸‹åˆ‡ã‚Šæ¨ã¦(0ï½dice[1] - 1)ã¾ã§ã®æ•°å€¤ã‚’åãå‡ºã™
      }
      console.log("[" + new Date() + "]:" + result);  // ãƒ­ã‚°ã«çµæœã‚’è¡¨ç¤º
      msg.send(result.toString());  // çµæœã‚’é€ä¿¡
      }
  });

  // 2é€²æ•°ã‚’å¤‰æ›ã™ã‚‹
  robot.hear(/bin[0-9]/i, (msg) => {
    var num = msg.message.text.split(/bin/i);
    var decNum = parseInt(num[1], 2);    // 10é€²æ•°ã«å¤‰æ›
    if (/[^0-1]/.test(num[1])) {
      console.log("[" + new Date() + "]:" + "æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
      msg.send("æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
    } else {
      console.log("[" + new Date() + "]:" + 
                  "ã€2é€²æ•°ã€" + decNum.toString(2) + "\n" +
                  "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                  "ã€10é€²æ•°ã€‘" + decNum + "\n" +
                  "ã€16é€²æ•°ã€‘" + decNum.toString(16));
      msg.send("ã€2é€²æ•°ã€" + decNum.toString(2) + "\n" +
                "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                "ã€10é€²æ•°ã€‘" + decNum + "\n" +
                "ã€16é€²æ•°ã€‘" + decNum.toString(16));
    }
  });

  // 8é€²æ•°ã‚’å¤‰æ›ã™ã‚‹
  robot.hear(/oct[0-9]/i, (msg) => {
    var num = msg.message.text.split(/oct/i);
    var decNum = parseInt(num[1], 8);
    if (/[^0-9]/.test(num[1])) {
      console.log("[" + new Date() + "]:" + "æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
      msg.send("æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
    } else {
      console.log("[" + new Date() + "]:" + 
                  "ã€8é€²æ•°ã€" + decNum.toString(8) + "\n" +
                  "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                  "ã€10é€²æ•°ã€‘" + decNum + "\n" +
                  "ã€16é€²æ•°ã€‘" + decNum.toString(16));
      msg.send("ã€8é€²æ•°ã€" + decNum.toString(8) + "\n" +
                "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                "ã€10é€²æ•°ã€‘" + decNum + "\n" +
                "ã€16é€²æ•°ã€‘" + decNum.toString(16));
    }
  });

  // 10é€²æ•°ã‚’å¤‰æ›ã™ã‚‹
  robot.hear(/dec[0-9]/i, (msg) => {
    var num = msg.message.text.split(/dec/i);
    var decNum = parseInt(num[1]);
    if (/[^0-9]/.test(num[1])) {
      console.log("[" + new Date() + "]:" + "æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
      msg.send("æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
    } else {
      console.log("[" + new Date() + "]:" + 
                  "ã€10é€²æ•°ã€" + decNum + "\n" +
                  "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                  "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                  "ã€16é€²æ•°ã€‘" + decNum.toString(16));
      msg.send("ã€10é€²æ•°ã€" + decNum + "\n" +
                "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                "ã€16é€²æ•°ã€‘" + decNum.toString(16));
    }
  });
  
  // 16é€²æ•°ã‚’å¤‰æ›ã™ã‚‹
  robot.hear(/hex[0-9a-z]/i, (msg) => {
    var num = msg.message.text.split(/hex/i);
    var decNum = parseInt(num[1], 16);
    if (/[^0-9a-f]/i.test(num[1])) {
      console.log("[" + new Date() + "]:" + "æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
      msg.send("æ•°å€¤ãŒé–“é•ã£ã¦ã‚‹ã‚ˆã€‚");
    } else {
      console.log("[" + new Date() + "]:" + 
                  "ã€16é€²æ•°ã€" + decNum.toString(16) + "\n" +
                  "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                  "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                  "ã€10é€²æ•°ã€‘" + decNum);
      msg.send("ã€16é€²æ•°ã€" + decNum.toString(16) + "\n" +
                "ã€2é€²æ•°ã€‘" + decNum.toString(2) + "\n" +
                "ã€8é€²æ•°ã€‘" + decNum.toString(8) + "\n" +
                "ã€10é€²æ•°ã€‘" + decNum);
    }
  });

};